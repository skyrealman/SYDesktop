<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx" 
		 xmlns:comp="com.sz.sydesktop.view.components.*"  width="100%" height="100%"
		 initialize="initializeHandler(event)" xmlns:control="com.sz.sydesktop.control.*" xmlns:business="com.sz.sydesktop.business.*">
	<fx:Script>
		<![CDATA[
			import com.sz.sydesktop.events.GetAppEvent;
			import com.sz.sydesktop.model.ModelLocator;
			import com.sz.sydesktop.util.Utillity;
			
			import mx.events.FlexEvent;
			
			protected function initializeHandler(event:FlexEvent):void
			{
				NativeApplication.nativeApplication.addEventListener(BrowserInvokeEvent.BROWSER_INVOKE, function listener(e:BrowserInvokeEvent):void{
					if(e.arguments.length == 3){
						var token:String = e.arguments[0] + "@" + e.arguments[1];
						Utillity.saveToken(token);
						NativeApplication.nativeApplication.exit();
					}else
						NativeApplication.nativeApplication.exit();
				});
				var USER_TOKEN:String = Utillity.readToken();
				if(USER_TOKEN != null){
					ModelLocator.USER_TOKEN = USER_TOKEN;
					var getAppEvent:GetAppEvent = new GetAppEvent();
					getAppEvent.dispatch();
				}
			}
			
		]]>
	</fx:Script>
	<fx:Declarations>
		<control:AppControl />
		<control:PendingControl />
		<business:Services />
	</fx:Declarations>
	<mx:VBox width="25%">
		<comp:PendingPanel />
		<comp:TrackPanel />
	</mx:VBox>
	<mx:VBox width="50%">
		<comp:CalendarPanel />
	</mx:VBox>
	<mx:VBox>
		<comp:ContactPanel />
		<comp:MemoPanel />
	</mx:VBox>
</mx:HBox>
